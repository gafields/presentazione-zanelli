@let data$ = data();

<div class="apod-container">
  <app-page-header
    title="Astronomy Picture of the Day"
    description="Discover the cosmos! Each day a different image or photograph of our fascinating universe is featured, along with a brief explanation written by a professional astronomer."
  />

  <div>
    <button mat-button (click)="previousDay()">
      <mat-icon>chevron_left</mat-icon>
    </button>
    <input
      type="date"
      [ngModel]="dateModel"
      (ngModelChange)="onDateChanged($event)"
      [max]="today"
    />
    <button mat-button [disabled]="nextDisabled()" (click)="nextDay()">
      <mat-icon>chevron_right</mat-icon>
    </button>
  </div>

  @if (isLoading()) {
    <mat-card appearance="outlined" class="apod-card">
      <div class="apod-image-placeholder">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
        <p>New image approaching...</p>
      </div>
      <mat-card-header>
        <mat-card-title>Loading...</mat-card-title>
        <mat-card-subtitle>Fetching today's picture</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <p class="apod-explanation">
          Connect to the NASA APOD API to display the daily astronomy picture and its description.
        </p>
      </mat-card-content>
    </mat-card>
  }
  @if (data$ && !isLoading()) {
    <mat-card appearance="outlined" class="apod-card">
      <a class="expand-button" matButton="text" (click)="expand(data$.url)">
        <mat-icon>zoom_in</mat-icon>
        View Full Image
      </a>
      <img [src]="data$.url" alt="Astronomy Picture of the Day" class="apod-image" />
      <mat-card-header>
        <mat-card-title>{{ data$.title }}</mat-card-title>
        <mat-card-subtitle>{{ data$.date }}</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <p class="apod-explanation">
          {{ data$.explanation }}
        </p>
      </mat-card-content>
    </mat-card>
  }
</div>
